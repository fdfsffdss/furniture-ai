# Railway configuration for monolithic app (Backend + Frontend)
# Backend serves both API and static Next.js frontend

builder = "nixpacks"

[[build.nixpacks.pkgs]]
name = "nodejs"
version = "20"

[build.nixpacks.variables]
NODE_ENV = "production"
NPM_PRODUCTION = "false"

[build.nixpacks.commands]
install = "npm install --no-save && cd ../frontend && npm install --no-save && cd ../backend"
build = "npm run build:frontend"

[processes]
web = "cd backend && node src/index.js"

# Health check endpoint
[processes.web.healthCheck]
interval = 30
timeout = 10
path = "/health"
